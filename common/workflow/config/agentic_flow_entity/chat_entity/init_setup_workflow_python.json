{
  "initial_state": "none",
  "workflow_name": "init_setup_workflow_python",
  "states": {
    "none": {
      "transitions": {
        "start_chat": {
          "next": "app_requirements_requested"
        }
      }
    },
    "app_requirements_requested": {
      "transitions": {
        "starting_chat": {
          "next": "prompt_app_requirements_step1"
        }
      }
    },
    "prompt_app_requirements_step1": {
      "transitions": {
        "prompt_sent": {
          "next": "app_requirements_step1",
          "action": {
            "name": "process_event",
            "config": {
              "type": "prompt",
              "approve": true,
              "model": {},
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "Hello! You’re the Cyoda client app setup assistant, and you’re here to help the user every step of the way.",
                    "Congratulate the user first—they’ve built the Cyoda application! Now, help the user get it started both locally and remotely.",
                    "Let the user know: the code they’ll be working with is in the branch {branch_name}. Make sure they use only this branch for the next steps.",
                    "You’ll guide them through the process one step at a time to ensure everything works smoothly. Let’s begin with the first step.",
                    "",
                    "**Step 1:** Let the user know: they should pull changes from remote and locate the .env.template file in the project’s root directory. Once they’ve found it, rename it to .env and open it in a text editor.",
                    "_Tip: Let the user know: they can confirm it’s in the root directory by using their code editor’s file tree or by running `ls` in the terminal._"
                  ]
                }
              ],
              "publish": true
            }
          }
        }
      }
    },
    "app_requirements_step1": {
      "transitions": {
        "process_user_input": {
          "next": "app_requirements_step1",
          "manual": true,
          "action": {
            "name": "process_event",
            "config": {
              "type": "agent",
              "publish": true,
              "allow_anonymous_users": true,
              "model": {},
              "tools": [
                {
                  "type": "function",
                  "function": {
                    "name": "read_link",
                    "description": "Read content from a URL. Use this function when you need to fetch content from a web resource. For example, if the user wants to add data sources for an API and provides an exact link, you should first read the link contents before proceeding with analysis.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "url": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "url"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "get_cyoda_guidelines",
                    "description": "Use this tool to generate configurations (workflows, entities, Cyoda settings) for informational purposes only, without modifying the application or saving data. If your goal is to change the application, this tool is not suitable. If it's unclear whether you need to modify the application or just need information, please clarify. The retrieved information can then be used to generate the required data without altering the application.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "workflow_name": {
                          "type": "string",
                          "enum": [
                            "generate_workflow",
                            "generate_processors",
                            "configure_trino",
                            "generate_entity",
                            "start_python_app",
                            "cyoda_best_practice"
                          ]
                        }
                      },
                      "required": [
                        "workflow_name"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "finish_discussion",
                    "description": "Use if the user is ready to proceed or asks to proceed to the next question. If the user wants to go to the next step - use immediately.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "transition": {
                          "type": "string",
                          "enum": [
                            "process_app_setup_1"
                          ]
                        }
                      },
                      "required": [
                        "transition"
                      ],
                      "additionalProperties": false
                    }
                  }
                }
              ],
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "**Troubleshooting:** Let the user know: if they can’t find the .env.template file, make sure they’re on the correct branch. If it’s still missing, check their .gitignore or ensure the repo was cloned fully, including any submodules."
                  ]
                }
              ],
              "tool_choice": "auto",
              "max_iteration": 30,
              "approve": true
            }
          }
        },
        "process_step1_success": {
          "next": "prompt_app_requirements_step2",
          "condition": {
            "config": {
              "type": "function",
              "function": {
                "name": "is_stage_completed",
                "parameters": {
                  "transition": "process_app_setup_1"
                }
              }
            }
          }
        }
      }
    },
    "prompt_app_requirements_step2": {
      "transitions": {
        "prompt_sent": {
          "next": "app_requirements_step2",
          "action": {
            "name": "process_event",
            "config": {
              "type": "prompt",
              "approve": true,
              "model": {},
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "**Step 2:** Let the user know: they should activate their virtual environment (e.g. `source .venv/bin/activate`), then launch the app with `python app.py` or via their IDE run configuration.",
                    "_Let the user know: they should see `ERROR:common.auth.cyoda_auth:Login failed (404)` as Cyoda isn’t configured yet._",
                    "- Let the user know: if they encounter `ModuleNotFoundError`, they should run `export PYTHONPATH=/your_dir/quart-client-template:$PYTHONPATH\n`.",
                    "- Let the user know: if they encounter `ModuleNotFoundError`, they should run `pip install -r requirements.txt`.",
                    "- Let the user know: they should use `python3 app.py` instead of `python app.py` in case of common errors."
                  ]
                }
              ],
              "publish": true
            }
          }
        }
      }
    },
    "app_requirements_step2": {
      "transitions": {
        "process_user_input": {
          "next": "app_requirements_step2",
          "manual": true,
          "action": {
            "name": "process_event",
            "config": {
              "type": "agent",
              "publish": true,
              "allow_anonymous_users": true,
              "model": {},
              "tools": [
                {
                  "type": "function",
                  "function": {
                    "name": "read_link",
                    "description": "Read content from a URL. Use this function when you need to fetch content from a web resource. For example, if the user wants to add data sources for an API and provides an exact link, you should first read the link contents before proceeding with analysis.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "url": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "url"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "get_cyoda_guidelines",
                    "description": "Use this tool to generate configurations (workflows, entities, Cyoda settings) for informational purposes only, without modifying the application or saving data. If your goal is to change the application, this tool is not suitable. If it's unclear whether you need to modify the application or just need information, please clarify. The retrieved information can then be used to generate the required data without altering the application.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "workflow_name": {
                          "type": "string",
                          "enum": [
                            "generate_workflow",
                            "generate_processors",
                            "configure_trino",
                            "generate_entity",
                            "start_python_app",
                            "cyoda_best_practice"
                          ]
                        }
                      },
                      "required": [
                        "workflow_name"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "finish_discussion",
                    "description": "Use if the user is ready to proceed or asks to proceed to the next question. If the user wants to go to the next step - use immediately.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "transition": {
                          "type": "string",
                          "enum": [
                            "process_app_setup_2"
                          ]
                        }
                      },
                      "required": [
                        "transition"
                      ],
                      "additionalProperties": false
                    }
                  }
                }
              ],
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "**Troubleshooting:**",
                    "- Let the user know: if they encounter `ModuleNotFoundError`, they should run `pip install -r requirements.txt`.",
                    "- Let the user know: if `quart` isn’t found, they should install it with `pip install quart`.",
                    "- Let the user know: if they see permission errors, they should try `python3 app.py` instead of `python app.py`."
                  ]
                }
              ],
              "tool_choice": "auto",
              "max_iteration": 30,
              "approve": true
            }
          }
        },
        "process_step2_success": {
          "next": "prompt_app_requirements_step3",
          "condition": {
            "config": {
              "type": "function",
              "function": {
                "name": "is_stage_completed",
                "parameters": {
                  "transition": "process_app_setup_2"
                }
              }
            }
          }
        }
      }
    },
    "prompt_app_requirements_step3": {
      "transitions": {
        "prompt_sent": {
          "next": "app_requirements_step3",
          "action": {
            "name": "process_event",
            "config": {
              "type": "agent",
              "tools": [
                {
                  "type": "function",
                  "function": {
                    "name": "deploy_cyoda_env",
                    "description": "Launches workflow that is necessary to deploy Cyoda environment for the user. User needs to explicitly ask for deployment of Cyoda environment.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "user_request": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "user_request"
                      ],
                      "additionalProperties": false
                    }
                  }
                }
              ],
              "model": {},
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "**Step 3:** Let the user know: now let’s configure their Cyoda Cloud instance.",
                    "- Let the user know: do they already have an environment?",
                    "  • Let the user know: if they do, let them decide whether they want to redeploy it. If they choose to redeploy, call the deploy cyoda env tool; otherwise, call finish_discussion.",
                    "  • Let the user know: if they don’t have a Cyoda environment yet, deploy a new Cyoda environment now (this may disrupt others!).",
                    "",
                    "Let the user know: they should let you know when they’ve checked their Cyoda environment and are ready to proceed with their app setup. Let the user know: the deployment will take several minutes, so check back in a couple of minutes."
                  ]
                }
              ],
              "publish": true
            }
          }
        }
      }
    },
    "app_requirements_step3": {
      "transitions": {
        "process_user_input": {
          "next": "app_requirements_step3",
          "manual": true,
          "action": {
            "name": "process_event",
            "config": {
              "type": "agent",
              "publish": true,
              "allow_anonymous_users": true,
              "model": {},
              "tools": [
                {
                  "type": "function",
                  "function": {
                    "name": "deploy_cyoda_env",
                    "description": "Launches workflow that is necessary to deploy Cyoda environment for the user. User needs to explicitly ask for deployment of Cyoda environment.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "user_request": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "user_request"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "finish_discussion",
                    "description": "Use if the user is ready to proceed or asks to proceed to the next question. If the user wants to go to the next step - use immediately.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "transition": {
                          "type": "string",
                          "enum": [
                            "process_app_setup_3"
                          ]
                        }
                      },
                      "required": [
                        "transition"
                      ],
                      "additionalProperties": false
                    }
                  }
                }
              ],
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "- Clarify if the user already has an environment",
                    "  • Let the user know: if they do, let them decide whether they want to redeploy it (this may disrupt others!). If they choose to redeploy, call the deploy cyoda env tool; otherwise, call finish_discussion.",
                    "  • Let the user know: if they don’t have a Cyoda environment yet, deploy a new Cyoda environment now .",
                    "",
                    "Let the user know: they should let you know when they’ve checked their Cyoda environment and are ready to proceed with their app setup. Let the user know: the deployment will take several minutes, so check back in a couple of minutes.",
                    " Ask the user confirm that their environment is deployed and they are happy with the result. ",
                    " Once the user tells you the env is ready/they are happy/done/ready to proceed finish_discussion immediately",
                    "**Troubleshooting:** Let the user know: N/A (deployment errors will be surfaced by the deployment tool)."
                  ]
                }
              ],
              "tool_choice": "auto",
              "max_iteration": 30
            }
          }
        },
        "process_step3_success": {
          "next": "prompt_app_requirements_step4",
          "condition": {
            "config": {
              "type": "function",
              "function": {
                "name": "is_stage_completed",
                "parameters": {
                  "transition": "process_app_setup_3"
                }
              }
            }
          }
        }
      }
    },
    "prompt_app_requirements_step4": {
      "transitions": {
        "prompt_sent": {
          "next": "app_requirements_step4",
          "action": {
            "name": "process_event",
            "config": {
              "type": "prompt",
              "approve": true,
              "model": {},
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "**Step 4:** Let the user know: they should edit their `.env` file with the required environment-specific value for `CYODA_HOST` (use their newly deployed host name).",
                    "- Let the user know: all other properties can stay at their defaults.",
                    "- Let the user know: their branch name is used for `GRPC_PROCESSOR_TAG` (they can change it if they like)."
                  ]
                }
              ],
              "publish": true
            }
          }
        }
      }
    },
    "app_requirements_step4": {
      "transitions": {
        "process_user_input": {
          "next": "app_requirements_step4",
          "manual": true,
          "action": {
            "name": "process_event",
            "config": {
              "type": "agent",
              "publish": true,
              "allow_anonymous_users": true,
              "model": {},
              "tools": [
                {
                  "type": "function",
                  "function": {
                    "name": "get_cyoda_guidelines",
                    "description": "Use this tool to generate configurations (workflows, entities, Cyoda settings) for informational purposes only, without modifying the application or saving data. If your goal is to change the application, this tool is not suitable. If it's unclear whether you need to modify the application or just need information, please clarify. The retrieved information can then be used to generate the required data without altering the application.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "workflow_name": {
                          "type": "string",
                          "enum": [
                            "generate_workflow",
                            "generate_processors",
                            "configure_trino",
                            "generate_entity",
                            "start_python_app",
                            "cyoda_best_practice"
                          ]
                        }
                      },
                      "required": [
                        "workflow_name"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "finish_discussion",
                    "description": "Use if the user is ready to proceed or asks to proceed to the next question. If the user wants to go to the next step - use immediately.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "transition": {
                          "type": "string",
                          "enum": [
                            "process_app_setup_4"
                          ]
                        }
                      },
                      "required": [
                        "transition"
                      ],
                      "additionalProperties": false
                    }
                  }
                }
              ],
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "**Troubleshooting:** Let the user know: missing or malformed values may cause runtime errors—ensure there are no stray spaces and quotes only where needed."]
                }
              ],
              "tool_choice": "auto",
              "max_iteration": 30,
              "approve": true
            }
          }
        },
        "process_step4_success": {
          "next": "prompt_app_requirements_step5",
          "condition": {
            "config": {
              "type": "function",
              "function": {
                "name": "is_stage_completed",
                "parameters": {
                  "transition": "process_app_setup_4"
                }
              }
            }
          }
        }
      }
    },
    "prompt_app_requirements_step5": {
      "transitions": {
        "prompt_sent": {
          "next": "app_requirements_step5",
          "action": {
            "name": "process_event",
            "config": {
              "type": "prompt",
              "approve": true,
              "model": {},
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "**Step 5:** Let the user know: with their env configured, they should import the workflows by running:",
                    "```bash",
                    "python common/repository/cyoda/cyoda_init.py",
                    "```",
                    "Let the user know: the workflows should appear in their Cyoda UI once the import completes."
                  ]
                }
              ],
              "publish": true
            }
          }
        }
      }
    },
    "app_requirements_step5": {
      "transitions": {
        "process_user_input": {
          "next": "app_requirements_step5",
          "manual": true,
          "action": {
            "name": "process_event",
            "config": {
              "type": "agent",
              "publish": true,
              "allow_anonymous_users": true,
              "model": {},
              "tools": [
                {
                  "type": "function",
                  "function": {
                    "name": "read_link",
                    "description": "Read content from a URL. Use this function when you need to fetch content from a web resource. For example, if the user wants to add data sources for an API and provides an exact link, you should first read the link contents before proceeding with analysis.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "url": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "url"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "add_new_entity_for_existing_app",
                    "description": "Launches workflow that is necessary to help the user add a new entity to the existing application. Key factor is that an application already exists and the user explicitly asks to add a new entity (else default to edit_existing_app_design_additional_feature). if the user doesn't specify the branch, ask yourself. Git branch is required. Ask the user explicitly or use the last branch from messages. Never default to main branch.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "git_branch": {
                          "type": "string"
                        },
                        "user_request": {
                          "type": "string"
                        },
                        "entity_name": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "user_request",
                        "git_branch",
                        "entity_name"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "add_new_workflow",
                    "description": "Launches workflow that is necessary to help the user add a new workflow. Key factor is that an application already exists and the user explicitly asks to add a new workflow (else default to edit_existing_app_design_additional_feature). if the user doesn't specify the branch, ask yourself.  Git branch is required. Ask the user explicitly or use the last branch from messages. Never default to main branch.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "git_branch": {
                          "type": "string"
                        },
                        "user_request": {
                          "type": "string"
                        },
                        "entity_name": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "user_request",
                        "git_branch",
                        "entity_name"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "edit_api_existing_app",
                    "description": "Launches workflow that is necessary to help the user edit/update existing api (routes.py). Key factor is that an application already exists and the user explicitly asks to add changes to its api/routes/routes.py  (else default to edit_existing_app_design_additional_feature). If the user doesn't specify the branch, ask yourself.  Git branch is required. Ask the user explicitly or use the last branch from messages. Never default to main branch.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "git_branch": {
                          "type": "string"
                        },
                        "user_request": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "user_request",
                        "git_branch"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "edit_existing_workflow",
                    "description": "Launches workflow that is necessary to help the user edit an existing workflow/workflow json. Key factor is that an application already exists and the user explicitly asks to update a workflow (else default to edit_existing_app_design_additional_feature). if the user doesn't specify the branch, ask yourself.  Git branch is required. Ask the user explicitly or use the last branch from messages. Never default to main branch.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "git_branch": {
                          "type": "string"
                        },
                        "user_request": {
                          "type": "string"
                        },
                        "entity_name": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "user_request",
                        "git_branch",
                        "entity_name"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "edit_existing_processors",
                    "description": "Launches workflow that is necessary to help the user update workflow processors code. Key factor is that an application already exists and the user explicitly asks to edit/update workflow processors/functions/workflow.py code (else default to edit_existing_app_design_additional_feature). if the user doesn't specify the branch, ask yourself.  Git branch is required. Ask the user explicitly or use the last branch from messages. Never default to main branch.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "git_branch": {
                          "type": "string"
                        },
                        "user_request": {
                          "type": "string"
                        },
                        "entity_name": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "user_request",
                        "git_branch",
                        "entity_name"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "get_cyoda_guidelines",
                    "description": "Use this tool to generate configurations (workflows, entities, Cyoda settings) for informational purposes only, without modifying the application or saving data. If your goal is to change the application, this tool is not suitable. If it's unclear whether you need to modify the application or just need information, please clarify. The retrieved information can then be used to generate the required data without altering the application.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "workflow_name": {
                          "type": "string",
                          "enum": [
                            "generate_workflow",
                            "generate_processors",
                            "configure_trino",
                            "generate_entity",
                            "start_python_app",
                            "cyoda_best_practice"
                          ]
                        }
                      },
                      "required": [
                        "workflow_name"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "finish_discussion",
                    "description": "Use if the user is ready to proceed or asks to proceed to the next question. If the user wants to go to the next step - use immediately.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "transition": {
                          "type": "string",
                          "enum": [
                            "process_app_setup_5"
                          ]
                        }
                      },
                      "required": [
                        "transition"
                      ],
                      "additionalProperties": false
                    }
                  }
                }
              ],
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "**Troubleshooting:** Let the user know: if the import fails, they should verify their JSON formats and version compatibility, and check the Cloud logs for detailed import errors."]
                }
              ],
              "tool_choice": "auto",
              "max_iteration": 30,
              "approve": true
            }
          }
        },
        "process_step5_success": {
          "next": "prompt_app_requirements_step6",
          "condition": {
            "config": {
              "type": "function",
              "function": {
                "name": "is_stage_completed",
                "parameters": {
                  "transition": "process_app_setup_5"
                }
              }
            }
          }
        }
      }
    },
    "prompt_app_requirements_step6": {
      "transitions": {
        "prompt_sent": {
          "next": "app_requirements_step6",
          "action": {
            "name": "process_event",
            "config": {
              "type": "prompt",
              "approve": true,
              "model": {},
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "**Step 6:** Let the user know: they should test their API by visiting `http://localhost:8000` (or their configured port) and ensure everything looks good.",
                    "- Let the user know: when they save `{entity_name}`, an event will be sent and processed by their workflow code in `entity/{entity_name}/workflow.py` and the corresponding JSON."
                  ]
                }
              ],
              "publish": true
            }
          }
        }
      }
    },
    "app_requirements_step6": {
      "transitions": {
        "process_user_input": {
          "next": "app_requirements_step6",
          "manual": true,
          "action": {
            "name": "process_event",
            "config": {
              "type": "agent",
              "publish": true,
              "allow_anonymous_users": true,
              "model": {},
              "tools": [
                {
                  "type": "function",
                  "function": {
                    "name": "read_link",
                    "description": "Read content from a URL. Use this function when you need to fetch content from a web resource. For example, if the user wants to add data sources for an API and provides an exact link, you should first read the link contents before proceeding with analysis.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "url": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "url"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "edit_existing_app_design_additional_feature",
                    "description": "Launches workflow that is necessary to help the user plan how to edit an existing application or add a new feature. Key factor is that an application already exists. if the user doesn't specify the branch, ask yourself.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "git_branch": {
                          "type": "string"
                        },
                        "user_request": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "user_request",
                        "git_branch"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "add_new_entity_for_existing_app",
                    "description": "Launches workflow that is necessary to help the user add a new entity to the existing application. Key factor is that an application already exists and the user explicitly asks to add a new entity (else default to edit_existing_app_design_additional_feature). if the user doesn't specify the branch, ask yourself. Git branch is required. Ask the user explicitly or use the last branch from messages. Never default to main branch.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "git_branch": {
                          "type": "string"
                        },
                        "user_request": {
                          "type": "string"
                        },
                        "entity_name": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "user_request",
                        "git_branch",
                        "entity_name"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "add_new_workflow",
                    "description": "Launches workflow that is necessary to help the user add a new workflow. Key factor is that an application already exists and the user explicitly asks to add a new workflow (else default to edit_existing_app_design_additional_feature). if the user doesn't specify the branch, ask yourself.  Git branch is required. Ask the user explicitly or use the last branch from messages. Never default to main branch.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "git_branch": {
                          "type": "string"
                        },
                        "user_request": {
                          "type": "string"
                        },
                        "entity_name": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "user_request",
                        "git_branch",
                        "entity_name"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "edit_api_existing_app",
                    "description": "Launches workflow that is necessary to help the user edit/update existing api (routes.py). Key factor is that an application already exists and the user explicitly asks to add changes to its api/routes/routes.py  (else default to edit_existing_app_design_additional_feature). If the user doesn't specify the branch, ask yourself.  Git branch is required. Ask the user explicitly or use the last branch from messages. Never default to main branch.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "git_branch": {
                          "type": "string"
                        },
                        "user_request": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "user_request",
                        "git_branch"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "edit_existing_workflow",
                    "description": "Launches workflow that is necessary to help the user edit an existing workflow/workflow json. Key factor is that an application already exists and the user explicitly asks to update a workflow (else default to edit_existing_app_design_additional_feature). if the user doesn't specify the branch, ask yourself.  Git branch is required. Ask the user explicitly or use the last branch from messages. Never default to main branch.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "git_branch": {
                          "type": "string"
                        },
                        "user_request": {
                          "type": "string"
                        },
                        "entity_name": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "user_request",
                        "git_branch",
                        "entity_name"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "edit_existing_processors",
                    "description": "Launches workflow that is necessary to help the user update workflow processors code. Key factor is that an application already exists and the user explicitly asks to edit/update workflow processors/functions/workflow.py code (else default to edit_existing_app_design_additional_feature). if the user doesn't specify the branch, ask yourself.  Git branch is required. Ask the user explicitly or use the last branch from messages. Never default to main branch.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "git_branch": {
                          "type": "string"
                        },
                        "user_request": {
                          "type": "string"
                        },
                        "entity_name": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "user_request",
                        "git_branch",
                        "entity_name"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "get_cyoda_guidelines",
                    "description": "Use this tool to generate configurations (workflows, entities, Cyoda settings) for informational purposes only, without modifying the application or saving data. If your goal is to change the application, this tool is not suitable. If it's unclear whether you need to modify the application or just need information, please clarify. The retrieved information can then be used to generate the required data without altering the application.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "workflow_name": {
                          "type": "string",
                          "enum": [
                            "generate_workflow",
                            "generate_processors",
                            "configure_trino",
                            "generate_entity",
                            "start_python_app",
                            "cyoda_best_practice"
                          ]
                        }
                      },
                      "required": [
                        "workflow_name"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "finish_discussion",
                    "description": "Use if the user is ready to proceed or asks to proceed to the next question. If the user wants to go to the next step - use immediately.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "transition": {
                          "type": "string",
                          "enum": [
                            "process_app_setup_6"
                          ]
                        }
                      },
                      "required": [
                        "transition"
                      ],
                      "additionalProperties": false
                    }
                  }
                }
              ],
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "**Troubleshooting:**",
                    "- Let the user know: if they can’t access the server, they should check that it’s still running and that their firewall allows local traffic.",
                    "- Let the user know: if no GRPC event occurs, they should verify their endpoint triggers GRPC and inspect the logs to trace payload delivery."]
                }
              ],
              "tool_choice": "auto",
              "max_iteration": 30,
              "approve": true
            }
          }
        },
        "process_step6_success": {
          "next": "prompt_app_requirements_step7",
          "condition": {
            "config": {
              "type": "function",
              "function": {
                "name": "is_stage_completed",
                "parameters": {
                  "transition": "process_app_setup_6"
                }
              }
            }
          }
        }
      }
    },
    "prompt_app_requirements_step7": {
      "transitions": {
        "prompt_sent": {
          "next": "app_requirements_step7",
          "action": {
            "name": "process_event",
            "config": {
              "type": "prompt",
              "model": {},
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "**Step 7:** Let the user know: now that the client application is running smoothly on their local machine, ask if they would like to deploy it to their Cyoda Cloud environment.",
                    "Let the user know: this deployment will provision the app into our Kubernetes cluster using the Helm charts located in the project’s `helm/` directory.",
                    "Let the user know: if they approve, deploy the user application and pass the session branch name.",
                    "Let the user know: if they deny, call `finish_discussion`."
                  ]
                }
              ],
              "publish": true
            }
          }
        }
      }
    },
    "app_requirements_step7": {
      "transitions": {
        "process_user_input": {
          "next": "app_requirements_step7",
          "manual": true,
          "action": {
            "name": "process_event",
            "config": {
              "type": "agent",
              "publish": true,
              "allow_anonymous_users": true,
              "model": {},
              "tools": [
                {
                  "type": "function",
                  "function": {
                    "name": "deploy_user_application",
                    "description": "Launches workflow that is necessary to deploy user client application (external calculation node). User needs to explicitly ask for deployment of their application. Branch is required.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "git_branch": {
                          "type": "string"
                        },
                        "user_request": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "user_request",
                        "git_branch"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "finish_discussion",
                    "description": "Use if the user is ready to proceed or asks to proceed to the next question. If the user wants to go to the next step - use immediately.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "transition": {
                          "type": "string",
                          "enum": [
                            "process_app_setup_7"
                          ]
                        }
                      },
                      "required": [
                        "transition"
                      ],
                      "additionalProperties": false
                    }
                  }
                }
              ],
              "messages": [
                {
                  "role": "user",
                  "content": [
                    " If the user asks to deploy their application - call deploy user app. "]
                }
              ],
              "tool_choice": "auto",
              "max_iteration": 30,
              "approve": true
            }
          }
        },
        "process_step7_success": {
          "next": "ready_to_lock_chat",
          "condition": {
            "config": {
              "type": "function",
              "function": {
                "name": "is_stage_completed",
                "parameters": {
                  "transition": "process_app_setup_7"
                }
              }
            }
          }
        }
      }
    },
    "ready_to_lock_chat": {
      "transitions": {
        "lock_chat": {
          "next": "locked_chat",
          "action": {
            "name": "process_event",
            "config": {
              "type": "notification",
              "notification": "🎉 Congrats on launching your first app! Your hard work paid off—this is just the beginning. Keep iterating, stay creative, and aim high! 🚀 Join our [Discord](https://discord.gg/bwTRS3hA) to share feedback and stay updated. 🙌",
              "publish": true,
              "allow_anonymous_users": true
            }
          }
        }
      }
    }
  }
}
