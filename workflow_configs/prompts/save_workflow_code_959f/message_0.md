Which workflow would you recommend for this code?
 How would you split this code into functions and condition functions (return boolean) so that you can use them in the workflow transitions