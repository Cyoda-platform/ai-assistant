{
  "initial_state": "none",
  "states": {
    "start": {
      "transitions": {
        "ask_for_location": {
          "next": "location_request",
          "action": {
            "name": "process_event",
            "config": {
              "type": "question",
              "question": "Please provide your location.",
              "example_answers": [
                "Location A",
                "Location B"
              ],
              "publish": true,
              "allow_anonymous_users": true
            }
          }
        }
      }
    },
    "location_request": {
      "transitions": {
        "receive_location": {
          "next": "location_received",
          "manual": true,
          "action": {
            "name": "process_event",
            "config": {
              "type": "agent",
              "publish": true,
              "allow_anonymous_users": true,
              "model": {},
              "tools": [
                {
                  "type": "function",
                  "function": {
                    "name": "get_weather_data",
                    "description": "Fetch weather data based on provided location.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "location": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "location"
                      ],
                      "additionalProperties": false
                    }
                  }
                }
              ],
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "Requesting weather data for the received location."
                  ]
                }
              ],
              "tool_choice": "auto",
              "max_iteration": 10,
              "approve": true
            }
          }
        }
      }
    },
    "location_received": {
      "transitions": {
        "request_weather": {
          "next": "weather_request",
          "action": {
            "name": "process_event",
            "config": {
              "type": "question",
              "question": "What weather information would you like?",
              "example_answers": [
                "Current temperature",
                "Forecast for the week"
              ],
              "publish": true,
              "allow_anonymous_users": true
            }
          }
        }
      }
    },
    "weather_request": {
      "transitions": {
        "provide_weather_info": {
          "next": "weather_info_received",
          "manual": false,
          "action": {
            "name": "process_event",
            "config": {
              "type": "agent",
              "publish": true,
              "allow_anonymous_users": true,
              "model": {},
              "tools": [
                {
                  "type": "function",
                  "function": {
                    "name": "get_weather_data",
                    "description": "Fetch weather data based on location.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "location": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "location"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                {
                  "type": "function",
                  "function": {
                    "name": "format_response",
                    "description": "Format the weather data response.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "object"
                        }
                      },
                      "required": [
                        "data"
                      ],
                      "additionalProperties": false
                    }
                  }
                }
              ],
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "Please provide the current weather information."
                  ]
                }
              ],
              "tool_choice": "auto",
              "max_iteration": 10,
              "approve": true
            }
          }
        }
      }
    },
    "weather_info_received": {
      "transitions": {
        "ask_for_feedback": {
          "next": "feedback_request",
          "action": {
            "name": "process_event",
            "config": {
              "type": "question",
              "question": "Was this information helpful?",
              "example_answers": [
                "Yes",
                "No"
              ],
              "publish": true,
              "allow_anonymous_users": true
            }
          }
        }
      }
    },
    "feedback_request": {
      "transitions": {
        "collect_feedback": {
          "next": "feedback_received",
          "manual": false,
          "action": {
            "name": "process_event",
            "config": {
              "type": "agent",
              "publish": true,
              "allow_anonymous_users": true,
              "model": {},
              "tools": [
                {
                  "type": "function",
                  "function": {
                    "name": "set_additional_question_flag",
                    "description": "Set a flag to ask additional questions during feedback.",
                    "strict": true,
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "transition": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "transition"
                      ],
                      "additionalProperties": false
                    }
                  }
                }
              ],
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "Please provide your feedback on the recent interaction."
                  ]
                }
              ],
              "tool_choice": "auto",
              "max_iteration": 10,
              "approve": true
            }
          }
        }
      }
    },
    "feedback_received": {
      "transitions": {
        "finish": {
          "next": "end",
          "action": {
            "name": "process_event",
            "config": {
              "type": "prompt",
              "messages": [
                {
                  "role": "user",
                  "content": [
                    "Thank you for your feedback!"
                  ]
                }
              ],
              "publish": true,
              "allow_anonymous_users": true
            }
          }
        }
      }
    }
  }
}